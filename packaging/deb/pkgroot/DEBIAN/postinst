#!/usr/bin/env bash
set -e

PKG_NAME="analyserhttp"
APP_DIR="/opt/$PKG_NAME"
VENV_DIR="$APP_DIR/.venv"

echo "[postinst] Setting up virtual environment..."
if [ ! -d "$VENV_DIR" ]; then
    python3 -m venv "$VENV_DIR"
fi
"$VENV_DIR/bin/pip" install --upgrade pip wheel
if [ -f "$APP_DIR/requirements.txt" ]; then
    "$VENV_DIR/bin/pip" install -r "$APP_DIR/requirements.txt"
else
    "$VENV_DIR/bin/pip" install customtkinter scapy matplotlib
fi

echo "[postinst] Done. You can run '$PKG_NAME' from your launcher or terminal."
